utility version for version 5.
All the code

